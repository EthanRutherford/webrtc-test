{"name":"jenny-js","files":{"jenny.js":{"/code":"function deepAssign(t,e){if(!canAssign(t)||!canAssign(e))return e;for(const n in e)t[n]=deepAssign(t[n],e[n]);return t}function jController(t,e){if(t.length>2||0===t.length)throw new Error(\"bad tag\");const n=okToConstruct=t[0],o=new n,r=Object.assign({children:e},t[1]);r.ref&&(o._ref=r.ref,delete r.ref),o.props=r,validate(!0,n.name,\"\",o.props,PropTypes.shapeOf(n.propTypes||{}));const i=o.init();return null!==i&&(i.controller=o,privacyMap.set(o,i)),o}function j(t,e=[]){if(t instanceof Array)return jController(t,e);if(1!==Object.keys(t).length)throw new Error(\"bad tag\");const n=Object.keys(t)[0],o=Object.assign({},t[n]),r=document.createElement(n);o.ref&&(r._ref=o.ref,delete o.ref);for(const t of Object.keys(o))r[t]=o[t];return r.append(...e.filter(t=>null!=t)),r}function prepareNode(t){return t instanceof Controller?t.model:t}function attach(t){for(const e of t.children||[])attach(e);t._ref instanceof Function&&t._ref(t),t.controller&&(t.controller._ref instanceof Function&&t.controller._ref(t.controller),t.controller.didMount instanceof Function&&t.controller.didMount())}function detach(t){for(const e of t.children||[])detach(e);t._ref instanceof Function&&t._ref(null),t.controller&&(t.controller._ref instanceof Function&&t.controller._ref(null),t.controller.didUnmount instanceof Function&&t.controller.didUnmount())}function observerCallback(t){for(const e of t){for(const t of e.addedNodes)attach(t);for(const t of e.removedNodes)detach(t)}}function validate(t,e,n,o,r,i=r.name){null!=o?r.prototype?o.constructor===r||o instanceof r||console.warn(`Failed propType '${n}: ${i}' in ${e}`):r(e,n,o):t&&console.warn(`Missing prop '${n}: ${i}' in ${e}`)}const privacyMap=new WeakMap;let okToConstruct=null;const indexModulo=(t,e)=>t<0?t%e+e:t,canAssign=t=>t&&t.constructor===Object||t instanceof Array;class JennyContentArray extends Array{constructor(...t){super(...t)}push(...t){return super.push.call(this,...this._parent.append(...t))}pop(){return super.pop.call(this).remove()}unshift(...t){return super.unshift.call(this,...this._parent.prepend(...t))}shift(){return super.shift.call(this).remove()}sort(t){return super.sort.call(this,t),this._parent.append(...this),this}reverse(){return super.reverse.call(this),this._parent.append(...this),this}splice(t,e,...n){return t=indexModulo(t,this.length),this[t]?this[t].before(...n):this._parent.append(...n),super.splice.call(this,t,e,...n).map(t=>t.remove())}replace(t,...e){const n=this[t].replaceWith(...e);super.splice.call(this,t,1,...n)}}class JennyElement extends Element{get content(){const t=new JennyContentArray(...this.childNodes);return t._parent=this,t}set content(t){for(;this.lastChild;)this.lastChild.remove();this.append(...t)}get computedStyle(){return getComputedStyle(this)}get class(){return this.classList}set class(t){return this.classList=t}}class Controller{constructor(){if(this.constructor!==okToConstruct)throw new Error(\"Illegal constructor\");const t=Object.getOwnPropertyDescriptors(this.__proto__),e=Object.keys(t).filter(e=>![\"constructor\",\"init\"].includes(e)&&t[e].value instanceof Function);for(const t of e)this[t]=this[t].bind(this);this.props={},okToConstruct=null}init(){return null}updateProps(t){const e=deepAssign({},this.props);this.props=deepAssign(this.props,t),validate(!0,this.constructor.name,\"\",this.props,PropTypes.shapeOf(this.constructor.propTypes||{})),this.propsChanged instanceof Function&&this.propsChanged(e)}get model(){return privacyMap.get(this)}remove(){this.model.remove()}}!function(){function t(t,e=!1){return function(...n){return n=n.map(t=>prepareNode(t)),t.call(this,...n),observerCallback(observer.takeRecords()),e?this:n}}function e(t){return function(...e){const n=t.call(this,...e);return observerCallback(observer.takeRecords()),n}}!function(e){for(const n of e)n.before=t(n.before),n.after=t(n.after),n.replaceWith=t(n.replaceWith),n.remove=t(n.remove,!0)}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),function(e){for(const n of e)n.append=t(n.append),n.prepend=t(n.prepend)}([Element.prototype,Document.prototype,DocumentFragment.prototype]),Node.prototype.appendChild=e(Node.prototype.appendChild),Node.prototype.insertBefore=e(Node.prototype.insertBefore),Node.prototype.removeChild=e(Node.prototype.removeChild),Node.prototype.replaceChild=e(Node.prototype.replaceChild),HTMLElement.prototype.__proto__=JennyElement.prototype}();const observer=new MutationObserver(observerCallback);observer.observe(document.body,{childList:!0,subtree:!0});const PropTypes={required:t=>(e,n,o)=>{validate(!0,e,n,o,t)},arrayOf:t=>(e,n,o)=>{validate(!1,e,n,o,Array);for(const r of o)validate(!1,e,n,r,t,`arrayOf(${t.name})`)},shapeOf:t=>(e,n,o)=>{validate(!1,e,n,o,Object);for(const n in t)validate(!1,e,n,o[n],t[n])}};module.exports={Controller:Controller,j:j,PropTypes:PropTypes};"}},"/deps":[],"entry":"/jenny.js"}